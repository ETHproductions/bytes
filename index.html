<!doctype html>
<html>
  <head>
    <title>bytes - The all-in-one online byte counter</title>
    <link rel="stylesheet" type="text/css" href="../style/style.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <style>
      * {
        background-color: transparent;
        font-family: Open Sans;
      }
      html {
        background-color: #BBB;
      }
      #bg {
        position: absolute;
        width: 66%;
        margin-left: 17%;
        margin-top: -10px;
        height: 3000px;
        max-height: 100%;
        background-color: #F8F8F8;
        z-index: -1;
      }
      #fg {
        position: absolute;
        width: 50%;
        margin-left: 25%;
      }
      textarea {
        margin-left: 0px;
        border-radius: 0px;
        font-family: Monaco, Consolas, monospace;
        background-color: #E9E9E9;
      }
      h1 {
        font-family: Monaco, Consolas, monospace;
        text-align: center;
      }
      h4 {
        text-align: center;
      }
    </style>
    <script>
      function update() { setTimeout(function(){
        var text = document.getElementById("text").value,
            encoding = document.getElementById("encoding").value
            bytes = 0, 
            chars = (text.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]|[^]/g)||[]).length,
            valid = true,
            encodings = [,"UTF-8","UTF-16","ISO-8859-1"];
        if (encoding == 1) bytes = text.replace(/([\uD800-\uDBFF][\uDC00-\uDFFF])|[^]/g,function(x,y){return y?"xxxx":x.charCodeAt(0)>=0x0800?"xxx":x.charCodeAt(0)>=0x0080?"xx":"x"}).length;
        else if (encoding == 2) bytes = text.length * 2;
        else if (encoding == 3) bytes = text.length, valid = /^[\x00-\xff]*$/.test(text);
        document.getElementById("bytes").innerHTML = "That's <b>" + chars + "</b> chars, " + (valid ? "totaling <b>" + bytes + "</b> " + encodings[encoding] + " bytes." : " but invalid " + encodings[encoding] + ".");
      },10); }
      function link() {
        window.history.pushState('', 'bytes - The all-in-one online byte counter',
          '/bytes/?e=' + document.getElementById('encoding').value
          + '\&t=' + encodeURIComponent(document.getElementById('text').value))
      }
    </script>
  </head>
  
  <body>
    <div id="bg"></div>
    <div id="fg">
      <h1>bytes</h1>
      <h4>The all-in-one online byte counter.</h4>
      <textarea rows=8 columns=40 id="text" onkeypress="update()">I â™¥ bytes</textarea>

      <p><span id="bytes"></span>&nbsp;<a href="" onclick="link()">Permalink</a></p>

      Choose a different encoding:
      <select id="encoding" onclick="update()">
        <option value="1" selected>UTF-8</option>
        <option value="2">UTF-16</option>
        <option value="3">ISO-8859-1</option>
      </select>
      <script>
        if(/e=\d+/.test(location.search))document.getElementById('encoding').value=location.search.match(/e=(\d+)/)[1];
        if(/t=.+/.test(location.search))document.getElementById('text').value=decodeURIComponent(location.search.match(/t=([^&]+)/)[1]);
        update();
      </script>
    </div>
  </body>
</html>
